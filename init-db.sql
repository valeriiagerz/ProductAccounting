-- Инициализация базы данных с тестовыми данными
-- Этот скрипт выполнится автоматически при первом запуске контейнера PostgreSQL

-- Создание таблицы products (TypeORM создаст её автоматически через synchronize: true)
-- Но мы можем добавить тестовые данные после того, как приложение запустится

-- Вставка тестовых данных (выполнится после создания таблицы приложением)
-- Для этого используем функцию, которая будет вызвана после инициализации TypeORM

-- Создаем функцию для вставки тестовых данных
DO $$
BEGIN
    -- Ждем, пока таблица будет создана TypeORM
    -- Вставляем тестовые данные только если их еще нет
    IF EXISTS (SELECT FROM information_schema.tables WHERE table_name = 'products') THEN
        IF NOT EXISTS (SELECT 1 FROM products LIMIT 1) THEN
            INSERT INTO products (article, name, price, quantity, "createdAt") VALUES
            ('NB-001', 'Хлеб', 899.00, 5, NOW()),
            ('NB-002', 'Молоко', 1200.00, 10, NOW()),
            ('NB-003', 'Яйца', 1500.00, 20, NOW()),
            ('NB-004', 'Масло', 2500.00, 8, NOW()),
            ('NB-005', 'Сахар', 1800.00, 15, NOW()),
            ('NB-006', 'Соль', 450.00, 30, NOW()),
            ('NB-007', 'Мука', 2200.00, 12, NOW()),
            ('NB-008', 'Макароны', 950.00, 25, NOW()),
            ('NB-009', 'Рис', 2100.00, 18, NOW()),
            ('NB-010', 'Гречка', 1900.00, 14, NOW());
        END IF;
    END IF;
END $$;

